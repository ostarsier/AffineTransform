# 2D视觉标定工具 (2D Vision Calibration Tool)

这是一个基于 Python Tkinter 开发的图形化（GUI）标定工具，用于计算相机2D像素坐标与机械臂2D世界坐标之间的仿射变换关系。

通过这个工具，用户可以方便地建立视觉系统与物理执行机构（如机械臂）之间的坐标映射，是实现视觉引导自动化任务（如抓取、定位、对准）的关键一步。

---

## 主要功能

- **图像加载**：支持加载多种格式的标定板图片（如 `.png`, `.jpg`）。
- **交互式取点**：用户可以直接在图像上点击，以交互方式获取特征点的像素坐标。
- **多种坐标输入方式**：
  - **从Excel加载**：批量从 `*.xlsx` 文件导入对应的机械臂坐标。
  - **手动输入**：逐个输入与点击点相对应的机械臂坐标。
- **仿射矩阵计算**：使用至少三对匹配的坐标点，自动计算出 2x3 的仿射变换矩阵。
- **精度验证**：提供坐标转换功能，用于验证计算出的矩阵的准确性，并显示转换误差。
- **数据导出**：将标定结果（包括仿射矩阵、坐标对应关系、误差分析）完整地导出一个 `.txt` 文件，方便后续在其他程序中调用。

---

## 依赖库

运行此程序需要安装以下 Python 库：

- **Tkinter**: Python 标准库，通常无需额外安装。
- **OpenCV**: 用于图像处理和仿射变换计算。
- **NumPy**: 用于高效的数值和矩阵运算。
- **Pandas**: 用于方便地读取 Excel 文件。
- **Pillow (PIL)**: 用于在 Tkinter 界面中显示 OpenCV 图像。

你可以通过以下命令使用 pip 安装所有依赖：

```bash
pip install opencv-python numpy pandas pillow
```

---

## 如何使用

1.  **准备工作**：
    - 准备一张标定板图片，图片中的特征点应清晰可辨。
    - 准备一个与标定板特征点一一对应的机械臂世界坐标列表。你可以将其保存在一个 Excel 文件中，包含 `x` 和 `y` 两列。

2.  **运行程序**：
    ```bash
    python3 GUI.py
    ```

3.  **标定流程**：
    - **步骤 1: 加载图片**
      - 点击 **`加载图片`** 按钮，选择你的标定板图片。

    - **步骤 2: 点击取点**
      - 按照固定顺序（例如，从左到右，从上到下）在图像的特征点上单击鼠标左键。每次点击，像素坐标会被记录下来，并在图像上显示一个红点。

    - **步骤 3: 加载机械臂坐标**
      - **方式一 (推荐)**: 点击 **`加载机械臂坐标 Excel`** 按钮，选择包含对应机械臂坐标的 Excel 文件。请确保 Excel 中坐标的顺序与你点击的顺序完全一致。
      - **方式二**: 依次点击 **`手动输入机械臂坐标`** 按钮，在弹出的窗口中为每一个点击的像素点输入其对应的机械臂坐标。

    - **步骤 4: 计算矩阵**
      - 当你提供了至少3对匹配的坐标点后，点击 **`计算仿射矩阵`** 按钮。计算出的矩阵将显示在界面上。

    - **步骤 5: 验证与导出**
      - (可选) 点击 **`验证转换`** 按钮，程序会使用最后一个采集的点进行坐标转换，并与其实际坐标对比，计算误差。
      - 点击 **`导出为 TXT`** 按钮，将所有标定数据保存为一个文本文件，以备后用。

    - **步骤 6: 退出**
      - 点击 **`退出`** 按钮关闭程序。

---

## 文件说明

- `GUI.py`: 程序的主文件，包含了所有的UI逻辑和标定算法实现。
- `README.md`: 本文档。
